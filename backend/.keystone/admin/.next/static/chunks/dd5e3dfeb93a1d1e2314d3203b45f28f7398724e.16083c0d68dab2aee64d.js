(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[7],{Ax7X:function(e,t,n){"use strict";n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return x})),n.d(t,"c",(function(){return E}));var r=n("cxan"),o=n("J8OT"),l=n("ERkP"),i=n.n(l),a=n("HbGN"),c=n("BO4l"),s=n("rkyN"),d=n("ALBq"),u=n("RxMK"),b=n("d01W"),f=n("rjhH"),g=n("3jXu"),O=n("q9nS"),p=n("UgQ6"),j=n.n(p),m=n("4/oc");const h=()=>{var e;const{headingStyles:t}=Object(o.t)(),{adminConfig:n}=Object(g.b)();return null!==(e=n.components)&&void 0!==e&&e.Logo?Object(o.n)(n.components.Logo,null):Object(o.n)(o.f,null,Object(o.n)(j.a,{href:"/",passHref:!0},Object(o.n)("a",{css:{color:t.h3.color,textDecoration:"none"}},"KeystoneJS")))},y=({href:e,children:t})=>{const{palette:n,spacing:r,radii:l,typography:i}=Object(o.t)(),a=Object(c.useRouter)(),s=a.pathname===e||a.pathname.split("/")[1]===e.split("/")[1];return Object(o.n)(O.a,{"aria-current":!!s&&"location",href:e,css:{background:"transparent",borderBottomRightRadius:l.xsmall,borderTopRightRadius:l.xsmall,color:n.neutral700,display:"block",fontWeight:i.fontWeight.medium,marginBottom:r.xsmall,marginRight:r.xlarge,padding:`${r.small}px ${r.xlarge}px`,position:"relative",textDecoration:"none",":hover":{background:n.blue50,color:n.blue500},"&[aria-current=location]":{background:n.neutral200,color:n.neutral900}}},t)},v=({item:e})=>{const{spacing:t,typography:n}=Object(o.t)();return Object(o.n)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",padding:t.xlarge}},Object(o.n)("div",{css:{fontSize:n.fontSize.small}},"Signed in as ",Object(o.n)("strong",null,e.label)),Object(o.n)(d.a,{placement:"bottom",triggerRenderer:({triggerProps:e})=>Object(o.n)(s.a,Object(r.a)({size:"small",style:{padding:0,width:36},"aria-label":"Links and signout"},e),Object(o.n)(u.a,null))},Object(o.n)(o.j,{gap:"medium",padding:"large",dividers:"between"},Object(o.n)(k,{target:"_blank",href:"/api/graphql"},"API Explorer"),Object(o.n)(k,{target:"_blank",href:"https://github.com/keystonejs/keystone"},"GitHub Repository"),Object(o.n)(k,{target:"_blank",href:"https://www.keystonejs.com/documentation"},"Keystone Documentation"),Object(o.n)(f.a,null))))},k=e=>{let{children:t}=e,n=Object(a.a)(e,["children"]);const{typography:l}=Object(o.t)();return Object(o.n)("a",Object(r.a)({css:{alignItems:"center",display:"flex",fontSize:l.fontSize.small,textDecoration:"none"}},n),t,Object(o.n)(b.a,{size:"small"}))},w=()=>{const{adminMeta:{lists:e},authenticatedItem:t,visibleLists:n}=Object(g.b)();return Object(o.n)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"center"}},"authenticated"===t.state&&Object(o.n)(v,{item:t}),Object(o.n)("nav",null,Object(o.n)(y,{href:"/"},"Dashboard"),"loading"===n.state?null:"error"===n.state?Object(o.n)("span",{css:{color:"red"}},n.error instanceof Error?n.error.message:n.error[0].message):Object.keys(e).map(t=>{if(!n.lists.has(t))return null;const r=e[t];return Object(o.n)(y,{key:t,href:"/"+r.path},e[t].label)})))},x=80,S=e=>Object(o.n)(l.Fragment,null,Object(o.n)("style",null,"body { overflow: hidden; }"),Object(o.n)("div",Object(r.a)({css:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) 4fr",gridTemplateRows:x+"px auto",height:"100vh"}},e))),C=e=>Object(o.n)("aside",Object(r.a)({css:{minWidth:0,overflowY:"auto",WebkitOverflowScrolling:"touch"}},e)),$=e=>{const{colors:t,spacing:n}=Object(o.t)();return Object(o.n)("main",Object(r.a)({css:{backgroundColor:t.background,boxSizing:"border-box",minWidth:0,paddingLeft:n.xlarge,paddingRight:n.xlarge,overflowY:"auto",WebkitOverflowScrolling:"touch"}},e))},E=({children:e,header:t})=>{const{colors:n,spacing:r}=Object(o.t)();return Object(o.n)(S,null,Object(o.n)("div",{css:{alignItems:"center",borderBottom:"1px solid "+n.border,display:"flex",justifyContent:"space-between",paddingLeft:r.xlarge,paddingRight:r.xlarge}},Object(o.n)(h,null)),Object(o.n)("header",{css:{alignItems:"center",backgroundColor:n.background,borderBottom:"1px solid "+n.border,display:"flex",justifyContent:"space-between",minWidth:0,paddingLeft:r.xlarge,paddingRight:r.xlarge}},t),Object(o.n)(C,null,Object(o.n)(w,null)),Object(o.n)($,null,e))};function P({errors:e,networkError:t}){return t?i.a.createElement(m.a,{tone:"negative"},t.message):null!==e&&void 0!==e&&e.length?i.a.createElement(o.j,{gap:"small"},e.map(e=>{var t,n;const r=e;return"ValidationFailureError"===e.name&&null!==(t=r.data)&&void 0!==t&&null!==(n=t.messages)&&void 0!==n&&n.length?r.data.messages.map(e=>i.a.createElement(m.a,{tone:"negative"},e)):i.a.createElement(m.a,{tone:"negative"},e.message)})):null}},DAgO:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("4wDe");function o(e){var t=function(e,t){if("object"!==Object(r.a)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==Object(r.a)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Object(r.a)(t)?t:String(t)}},RxMK:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ERkP"),o=(n("97Jx"),n("m3Bd"),n("J8OT"),n("s3d4"));const l=Object(o.a)(Object(r.createElement)(r.Fragment,null,Object(r.createElement)("circle",{cx:12,cy:12,r:1}),Object(r.createElement)("circle",{cx:19,cy:12,r:1}),Object(r.createElement)("circle",{cx:5,cy:12,r:1})),"MoreHorizontalIcon")},ZP4Z:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n("Czhu"),o=n("ERkP"),l=n("b2e3"),i=n.n(l),a=n("J8OT"),c=n("olln"),s=n("yTkC"),d=n("+C6t"),u=n("x8tt"),b=n("3jXu"),f=n("Ax7X");function g({listKey:e,onClose:t,onCreate:n}){const{createViewFieldModes:l}=Object(b.b)(),g=Object(b.c)(e),O=Object(s.b)(),[p,{loading:j,error:m}]=Object(u.useMutation)(u.gql`mutation($data: ${g.gqlNames.createInputName}!) {
      item: ${g.gqlNames.createMutationName}(data: $data) {
        id
        label: ${g.labelField}
    }
  }`),[h,y]=Object(o.useState)(()=>{const e={};return Object.keys(g.fields).forEach(t=>{e[t]=g.fields[t].controller.defaultValue}),e}),v=Object(o.useMemo)(()=>{const e=new Set;return Object.keys(h).forEach(t=>{const n=h[t],r=g.fields[t].controller.validate;if(r){!1===r(n)&&e.add(t)}}),e},[g,h]),[k,w]=Object(o.useState)(!1),x=Object.keys(g.fields).filter(t=>"loaded"===l.state&&"hidden"!==l.lists[e][t]).map((e,t)=>{const n=g.fields[e];return Object(a.n)(n.views.Field,{key:e,field:n.controller,value:h[e],forceValidation:k&&v.has(e),onChange:t=>{y(Object(r.a)(Object(r.a)({},h),{},{[e]:t}))},autoFocus:0===t})});return Object(a.n)(c.b,{title:"Create "+g.singular,width:"wide",actions:{confirm:{label:"Create "+g.singular,loading:j,action:()=>{const e=0!==v.size;if(w(e),e)return;const t={};Object.keys(g.fields).forEach(e=>{const{controller:n}=g.fields[e],r=n.serialize(h[e]);i()(r,n.serialize(n.defaultValue))||Object.assign(t,r)}),p({variables:{data:t}}).then(({data:e})=>{const t=e.item.label||e.item.id;n({id:e.item.id,label:t}),O.addToast({title:t,message:"Created Successfully",tone:"positive"})}).catch(()=>{})}},cancel:{label:"Cancel",action:t}}},"error"===l.state&&Object(a.n)(f.a,{networkError:l.error instanceof Error?l.error:void 0,errors:l.error instanceof Error?void 0:l.error}),"loading"===l.state&&Object(a.n)(d.a,{label:"Loading create form"}),m&&Object(a.n)(f.a,{networkError:null===m||void 0===m?void 0:m.networkError,errors:null===m||void 0===m?void 0:m.graphQLErrors}),Object(a.n)(a.j,{gap:"xlarge",paddingY:"xlarge"},x,0===x.length&&"There are no fields that you can read or edit"))}},d01W:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n("ERkP"),o=(n("97Jx"),n("m3Bd"),n("J8OT"),n("s3d4"));const l=Object(o.a)(Object(r.createElement)("polyline",{points:"9 18 15 12 9 6"}),"ChevronRightIcon")},ktBx:function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var r=n("cxan"),o=n("Czhu"),l=n("ERkP"),i=n("rkyN"),a=n("J8OT"),c=n("J3Wx"),s=(n("97Jx"),n("m3Bd"),n("s3d4"));const d=Object(s.a)(Object(l.createElement)(l.Fragment,null,Object(l.createElement)("circle",{cx:12,cy:12,r:10}),Object(l.createElement)("polyline",{points:"12 16 16 12 12 8"}),Object(l.createElement)("line",{x1:8,y1:12,x2:16,y2:12})),"ArrowRightCircleIcon");var u=n("+C6t"),b=n("olln"),f=n("yTkC"),g=n("x8tt"),O=n("HbGN"),p=n("oGee"),j=(n("KEM+"),n("qfee"),n("UgQ6"),n("3jXu")),m=n("BO4l"),h=n("ALBq"),y=(n("RxMK"),n("d01W")),v=(n("rjhH"),n("q9nS")),k=n("Ax7X"),w=n("ZP4Z"),x=(n("4/oc"),n("eecF"));const S=Object(s.a)(Object(l.createElement)("polyline",{points:"6 9 12 15 18 9"}),"ChevronDownIcon"),C=Object(s.a)(Object(l.createElement)("polyline",{points:"20 6 9 17 4 12"}),"CheckIcon");var $=n("x2tH"),E=n("BGTi");function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const I=({isDisabled:e,isFocused:t,isSelected:n})=>{const r=Object(c.k)({size:"medium",type:"radio"});return Object(a.n)("div",{className:`${e?"disabled ":""}${t?"focus ":""}${n?"selected":""}`,css:{alignItems:"center",backgroundColor:r.background,borderColor:r.borderColor,borderRadius:r.borderRadius,borderStyle:"solid",borderWidth:r.borderWidth,boxSizing:"border-box",color:r.foreground,cursor:"pointer",display:"flex",flexShrink:0,height:r.boxSize,justifyContent:"center",transition:r.transition,width:r.boxSize,"&.focus":{backgroundColor:r.focus.background,borderColor:r.focus.borderColor,boxShadow:r.focus.shadow,color:r.focus.foreground},"&.selected":{backgroundColor:r.selected.background,borderColor:r.selected.borderColor,boxShadow:r.selected.shadow,color:r.selected.foreground},"&.disabled":{backgroundColor:r.disabled.background,borderColor:r.disabled.borderColor,boxShadow:r.disabled.shadow,color:r.disabled.background,cursor:"default"},"&.selected.disabled":{color:r.disabled.foreground}}},Object(a.n)(C,{size:"small"}))},q=({children:e,isDisabled:t,innerProps:n,innerRef:o,className:l})=>{const i=Object(a.t)();return Object(a.n)("div",Object(r.a)({ref:o,className:l,css:{alignItems:"center",color:t?i.colors.foregroundDim:void 0,cursor:"pointer",display:"flex",fontSize:"0.9em",fontWeight:500,justifyContent:"space-between",outline:0,padding:i.spacing.small+"px 0",pointerEvents:t?"none":void 0,"&:not(:first-of-type)":{borderTop:"1px solid "+i.colors.backgroundDim}}},n),e)},D={Control:e=>{let{selectProps:t}=e,n=Object(O.a)(e,["selectProps"]);return t.shouldDisplaySearchControl?Object(a.n)($.f.Control,Object(r.a)({selectProps:t},n)):Object(a.n)("div",{css:{border:0,clip:"rect(1px, 1px, 1px, 1px)",height:1,overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:1}},Object(a.n)($.f.Control,Object(r.a)({selectProps:t},n)))},Option:q,DropdownIndicator:null,IndicatorSeparator:null},M=e=>{let{components:t}=e,n=Object(O.a)(e,["components"]);const o=Object(l.useMemo)(()=>z(z({},D),t),[t]),i=Object(a.t)(),c=Object(l.useMemo)(()=>({control:e=>z(z({},e),{},{background:i.fields.inputBackground,boxShadow:"none",cursor:"text",padding:0,minHeight:34}),menu:()=>({marginTop:8}),menuList:e=>z(z({},e),{},{padding:0}),placeholder:e=>z(z({},e),{},{color:i.fields.inputPlaceholder})}),[i]);return Object(a.n)(E.a,Object(r.a)({backspaceRemovesValue:!1,captureMenuScroll:!1,closeMenuOnSelect:!1,controlShouldRenderValue:!1,hideSelectedOptions:!1,isClearable:!1,isSearchable:true,maxMenuHeight:1e3,menuIsOpen:!0,menuShouldScrollIntoView:!1,shouldDisplaySearchControl:true,styles:c,tabSelectsValue:!1,components:o},n))},N=Object(s.a)(Object(l.createElement)("polyline",{points:"15 18 9 12 15 6"}),"ChevronLeftIcon");var F=n("DAgO"),_=n("I0W7");function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const W=e=>{let{tone:t,weight:n,onClick:o,tabIndex:l}=e,i=Object(O.a)(e,["tone","weight","onClick","tabIndex"]);const{radii:c,spacing:s,tones:d,typography:u}=Object(a.t)(),b=!!o,f=d[t],g={bold:{background:f.fill[0],foreground:f.fillForeground[0],focus:{shadow:"0 0 0 2px "+f.focusRing},hover:{background:f.fill[1]},active:{background:f.fill[2]}},light:{background:f.tint[0],foreground:f.foreground[0],focus:{shadow:"0 0 0 2px "+f.focusRing},hover:{foreground:f.foreground[1],background:f.tint[1]},active:{foreground:f.foreground[2],background:f.tint[2]}}}[n],p={alignItems:"center",appearance:"none",background:"none",backgroundColor:g.background,border:0,color:g.foreground,display:"flex",fontSize:u.fontSize.small,fontWeight:u.fontWeight.medium,justifyContent:"center",maxWidth:"100%",minWidth:1,outline:0,padding:`${s.small}px ${s.medium}px`,":first-of-type":{paddingRight:s.small,borderTopLeftRadius:c.full,borderBottomLeftRadius:c.full,marginRight:1},":last-of-type":{paddingLeft:s.small,borderTopRightRadius:c.full,borderBottomRightRadius:c.full},":only-of-type":{paddingLeft:s.medium,paddingRight:s.medium}},j=b?{cursor:"pointer",":focus":{boxShadow:g.focus.shadow},":hover,:focus":{backgroundColor:g.hover.background,color:g.hover.foreground},":active":{backgroundColor:g.active.background,color:g.active.foreground}}:{};return Object(a.n)("button",Object(r.a)({css:L(L({},p),j),onClick:o,tabIndex:b?l:-1},i))},K=Object(l.forwardRef)((e,t)=>{let{weight:n="bold",tone:o="active",children:l,onClick:i,onRemove:c}=e,s=Object(O.a)(e,["weight","tone","children","onClick","onRemove"]);return console.log(i),Object(a.n)("div",Object(r.a)({css:{display:"flex"}},s,{ref:t}),Object(a.n)(W,{weight:n,tone:o,onClick:i},l),c?Object(a.n)(W,{weight:n,tone:o,onClick:c},Object(a.n)(_.a,{css:{height:14,width:14}})):null)});n("yUr7"),n("z3d9"),n("6tix"),n("b2e3");function A(e,t){const{query:n}=Object(m.useRouter)(),r="string"===typeof n.fields?n.fields:"";return Object(l.useMemo)(()=>{let n=(r?r.split(","):e.initialColumns).filter(e=>"read"===t[e]);return new Set(0===n.length?[e.labelField]:n)},[e,r,t])}const V={Option:e=>Object(a.n)(q,e,e.children,Object(a.n)(I,{isDisabled:e.isDisabled,isFocused:e.isFocused,isSelected:e.isSelected}))};function J({list:e,fieldModesByFieldPath:t}){const n=Object(m.useRouter)(),l=A(e,t),c=[];return Object.keys(t).forEach(n=>{"read"===t[n]&&c.push({value:n,label:e.fields[n].label,isDisabled:1===l.size&&l.has(n)})}),Object(a.n)(h.a,{triggerRenderer:({triggerProps:e})=>Object(a.n)(i.a,Object(r.a)({weight:"link",css:{padding:4}},e),Object(a.n)("span",{css:{display:"inline-flex",justifyContent:"center",alignItems:"center"}},l.size," column",1===l.size?"":"s"," ",Object(a.n)(S,{size:"smallish"})))},Object(a.n)("div",{css:{width:320}},Object(a.n)(a.a,{padding:"medium"},Object(a.n)(M,{onChange:t=>{Array.isArray(t)&&(t=>{if(function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(t,e.initialColumns)){const e=n.query,t=Object(O.a)(e,["fields"]);n.push({query:t})}else n.push({query:Object(o.a)(Object(o.a)({},n.query),{},{fields:t.join(",")})})})(t.map(e=>e.value))},isMulti:!0,value:c.filter(e=>l.has(e.value)),options:c,components:V}))))}const H={Option:e=>{let{children:t}=e,n=Object(O.a)(e,["children"]),r=Object(a.t)(),o=n.isFocused?r.colors.foreground:r.colors.foregroundDim;return Object(a.n)(q,n,Object(a.n)("span",null,t),Object(a.n)("div",{css:{alignItems:"center",display:"flex",height:24,justifyContent:"center",width:24}},Object(a.n)(y.a,{css:{color:o}})))}};function G({listKey:e}){const{isOpen:t,setOpen:n,trigger:o,dialog:c,arrow:s}=Object(h.c)({placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,8]}}]});return Object(a.n)(l.Fragment,null,Object(a.n)(i.a,Object(r.a)({tone:"active",size:"small"},o.props,{ref:o.ref,onClick:()=>n(!0)}),Object(a.n)(a.a,{as:"span",marginRight:"xsmall"},"Filter List"),Object(a.n)(S,{size:"small"})),Object(a.n)(h.b,Object(r.a)({arrow:s,isVisible:t},c.props,{ref:c.ref}),t&&Object(a.n)(Q,{onClose:()=>{n(!1)},listKey:e})))}function Q({onClose:e,listKey:t}){const n=Object(j.c)(t),r=Object(m.useRouter)(),s=Object(l.useMemo)(()=>{const e={};return Object.keys(n.fields).forEach(t=>{const r=n.fields[t];r.controller.filter&&(e[t]=r)}),e},[n.fields]),d=Object(l.useMemo)(()=>{const e={};return Object.keys(s).forEach(t=>{const n=s[t];let o=!1;const l={};Object.keys(n.controller.filter.types).forEach(e=>{void 0===r.query[`!${t}_${e}`]&&(o=!0,l[e]=n.controller.filter.types[e].label)}),o&&(e[t]=l)}),e},[r.query,s]),[u,b]=Object(l.useState)({kind:"selecting-field"});return Object(a.n)(a.j,{padding:"medium",as:"form",css:{minWidth:320},onSubmit:t=>{t.preventDefault(),"filter-value"===u.kind&&(r.push({query:Object(o.a)(Object(o.a)({},r.query),{},{[`!${u.fieldPath}_${u.filterType}`]:JSON.stringify(u.filterValue)})}),e())},gap:"small"},Object(a.n)("div",{css:{position:"relative"}},"selecting-field"!==u.kind&&Object(a.n)("button",{onClick:()=>{b({kind:"selecting-field"})},css:{border:0,background:"transparent",cursor:"pointer",position:"absolute"}},Object(a.n)(a.l,null,"Back"),Object(a.n)(N,{size:"smallish"})),Object(a.n)(a.g,{textAlign:"center",type:"h5"},(()=>{switch(u.kind){case"selecting-field":return"Filter";case"filter-value":return n.fields[u.fieldPath].label}})())),Object(a.n)(a.d,null),"selecting-field"===u.kind&&Object(a.n)(M,{components:H,onChange:e=>{const t=e.value,n=Object.keys(d[t])[0];b({kind:"filter-value",fieldPath:t,filterType:n,filterValue:s[t].controller.filter.types[n].initialValue})},options:Object.keys(d).map(e=>({label:s[e].label,value:e}))}),"filter-value"===u.kind&&Object(a.n)(c.g,{width:"full",value:{value:u.filterType,label:d[u.fieldPath][u.filterType]},onChange:e=>{e&&b({kind:"filter-value",fieldPath:u.fieldPath,filterValue:s[u.fieldPath].controller.filter.types[e.value].initialValue,filterType:e.value})},options:Object.keys(d[u.fieldPath]).map(e=>({label:d[u.fieldPath][e],value:e}))}),"filter-value"==u.kind&&(()=>{const{Filter:e}=s[u.fieldPath].controller.filter;return Object(a.n)(e,{type:u.filterType,value:u.filterValue,onChange:e=>{b(t=>Object(o.a)(Object(o.a)({},t),{},{filterValue:e}))}})})(),"filter-value"==u.kind&&Object(a.n)("div",{css:{display:"flex",justifyContent:"space-between"}},Object(a.n)(i.a,{onClick:e},"Cancel"),Object(a.n)(i.a,{type:"submit"},"Apply")))}function U({filters:e,list:t}){return Object(a.n)(a.h,{gap:"small"},e.map(e=>{const n=t.fields[e.field];return Object(a.n)(X,{key:`${e.field}_${e.type}`,field:n,filter:e})}))}function X({filter:e,field:t}){const n=Object(m.useRouter)(),{isOpen:o,setOpen:i,trigger:c,dialog:s,arrow:d}=Object(h.c)({placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,8]}}]}),u=t.controller.filter.Label;return Object(a.n)(l.Fragment,null,Object(a.n)(K,Object(r.a)({onClick:()=>{i(!0)}},c.props,{ref:c.ref,weight:"light",tone:"passive",onRemove:()=>{const t=n.query,r=`!${e.field}_${e.type}`,o=Object(O.a)(t,[r].map(F.a));n.push({query:o})}}),t.label," ",Object(a.n)(u,{label:t.controller.filter.types[e.type].label,type:e.type,value:e.value})),Object(a.n)(h.b,Object(r.a)({arrow:d},s.props,{ref:s.ref,isVisible:o}),Object(a.n)(Z,{onClose:()=>{i(!1)},field:t,filter:e})))}function Z({filter:e,field:t,onClose:n}){const r=t.controller.filter.Filter,c=Object(m.useRouter)(),[s,d]=Object(l.useState)(e.value);return Object(a.n)(a.j,{as:"form",padding:"small",gap:"small",onSubmit:t=>{t.preventDefault(),c.push({query:Object(o.a)(Object(o.a)({},c.query),{},{[`!${e.field}_${e.type}`]:JSON.stringify(s)})}),n()}},Object(a.n)(r,{autoFocus:!0,type:e.type,value:s,onChange:d}),Object(a.n)("div",{css:{display:"flex",justifyContent:"space-between"}},Object(a.n)(i.a,{onClick:n},"Cancel"),Object(a.n)(i.a,{type:"submit"},"Save")))}function Y({page:e,currentPage:t}){const{query:n}=Object(m.useRouter)(),r=Object(o.a)(Object(o.a)({},n),{},{page:e});return 1===e&&delete r.page,Object(a.n)(v.a,{css:{textDecoration:t===e?"none":void 0,color:t===e?"inherit":void 0},href:{query:r}},e)}function ee({currentPage:e,total:t,pageSize:n,listKey:r}){const o=Object(j.c)(r);if(t<=n)return null;const l=[],i=Math.ceil(t/n);let c=1,s=i;if(5<i){const t=Math.floor(2.5);c=e-(t+1-1),s=e+t,c<1&&(s=5,c=1),s>i&&(c=i-5+1,s=i)}c>1&&l.push(Object(a.n)(Y,{key:"page_start",currentPage:e,page:1}));for(let d=c;d<=s;d++)l.push(Object(a.n)(Y,{key:d,page:d,currentPage:e}));return s<i&&l.push(Object(a.n)(Y,{key:"page_end",page:i,currentPage:e})),Object(a.n)(a.b,null,Object(a.n)(a.j,{across:!0,gap:"small"},l),Object(a.n)(te,{currentPage:e,pageSize:n,plural:o.plural,singular:o.singular,total:t}))}function te({currentPage:e,pageSize:t,plural:n,singular:r,total:o}){if(!o)return Object(a.n)("span",null,"No ",n);let l="";const i=t*(e-1)+1,c=Math.min(i+t-1,o);return o>t?l=`${i} to ${c} of ${o} ${n}`:(l=o+" ",o>1&&n?l+=n:1===o&&r&&(l+=r)),Object(a.n)("span",null,"Showing ",Object(a.n)("strong",null,l))}function ne(e){const{query:t}=Object(m.useRouter)();let n="string"===typeof t.sortBy?t.sortBy:"";return Object(l.useMemo)(()=>{if(""===n)return e.initialSort;let t="ASC",r=n;return"-"===n.charAt(0)&&(r=n.substr(1),t="DESC"),e.fields[r].isOrderable?{field:r,direction:t}:null},[n,e])}function re({list:e}){const t=ne(e),{isOpen:n,setOpen:o,trigger:c,dialog:s,arrow:d}=Object(h.c)({placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,8]}}]});return Object(a.n)(l.Fragment,null,Object(a.n)(i.a,Object(r.a)({},c.props,{weight:"link",css:{padding:4},ref:c.ref,onClick:()=>o(!0)}),Object(a.n)("span",{css:{display:"inline-flex",justifyContent:"center",alignItems:"center"}},t?`${e.fields[t.field].label} ${{ASC:"ascending",DESC:"descending"}[t.direction]}`:"No field",Object(a.n)(S,{size:"smallish"}))),Object(a.n)(h.b,Object(r.a)({arrow:d,isVisible:n},s.props,{ref:s.ref}),n&&Object(a.n)(le,{onClose:()=>{o(!1)},list:e})))}const oe={label:"No field",value:"___________NO_FIELD___________"};function le({onClose:e,list:t}){const n=ne(t),r=Object(m.useRouter)();return Object(a.n)(a.j,{padding:"medium",css:{minWidth:320},gap:"small"},Object(a.n)("div",{css:{position:"relative"}},Object(a.n)(a.g,{textAlign:"center",type:"h5"},"Sort")),Object(a.n)(a.d,null),Object(a.n)(M,{value:n?{label:t.fields[n.field].label,value:n.field}:oe,components:V,onChange:t=>{const l=t.value;if(l===oe.value){const e=r.query,t=Object(O.a)(e,["sortBy"]);r.push({query:t})}else r.push({query:Object(o.a)(Object(o.a)({},r.query),{},{sortBy:(null===n||void 0===n?void 0:n.field)===l&&"ASC"===n.direction?"-"+n.field:l})});e()},options:Object.keys(t.fields).filter(e=>t.fields[e].isOrderable).map(e=>({label:t.fields[e].label,value:e})).concat(oe)}))}let ie=g.gql`
  query($listKey: String!) {
    keystone {
      adminMeta {
        list(key: $listKey) {
          hideDelete
          hideCreate
          fields {
            path
            listView {
              fieldMode
            }
          }
        }
      }
    }
  }
`;const ae=({listKey:e})=>{var t,n,r,i,c;const s=Object(j.c)(e),{query:d}=Object(m.useRouter)();!function(e){const t=Object(m.useRouter)(),n=`keystone.list.${e}.list.page.info`;Object(l.useEffect)(()=>{if(!Object.keys(t.query).some(e=>e.startsWith("!")||"page"===e||"pageSize"===e||"fields"===e)){const r=localStorage.getItem(n);let l;try{l=JSON.parse(r)}catch(e){}l&&t.replace({query:Object(o.a)(Object(o.a)({},t.query),l)})}},[n]),Object(l.useEffect)(()=>{let n={};Object.keys(t.query).forEach(e=>{(e.startsWith("!")||"page"===e||"pageSize"===e||"fields"===e)&&(n[e]=t.query[e])}),Object.keys(n).length?localStorage.setItem(`keystone.list.${e}.list.page.info`,JSON.stringify(n)):localStorage.removeItem(`keystone.list.${e}.list.page.info`)},[n,t])}(e);let b="string"!==typeof d.page||Number.isNaN(parseInt(d.page))?1:Number(d.page),f="string"!==typeof d.pageSize||Number.isNaN(parseInt(d.pageSize))?s.pageSize:parseInt(d.pageSize);const O=ne(s),p=function(e){const{query:t}=Object(m.useRouter)(),n=Object(l.useMemo)(()=>{const t={};return Object.entries(e.fields).forEach(([e,n])=>{n.controller.filter&&Object.keys(n.controller.filter.types).forEach(n=>{t[`!${e}_${n}`]={type:n,field:e}})}),t},[e]);return Object(l.useMemo)(()=>{let r=[];Object.keys(t).forEach(e=>{const l=n[e],i=t[e];if(l&&"string"===typeof i){let e;try{e=JSON.parse(i)}catch(a){}void 0!==i&&r.push(Object(o.a)(Object(o.a)({},l),{},{value:e}))}});let l={};return r.forEach(t=>{Object.assign(l,e.fields[t.field].controller.filter.graphql({type:t.type,value:t.value}))}),{filters:r,where:l}},[t,n,e])}(s);let h=Object(g.useQuery)(ie,{variables:{listKey:e}}),y=Object(l.useMemo)(()=>{var e,t;let n={};return null===(e=h.data)||void 0===e||null===(t=e.keystone.adminMeta.list)||void 0===t||t.fields.forEach(e=>{n[e.path]=e.listView.fieldMode}),n},[null===(t=h.data)||void 0===t||null===(n=t.keystone.adminMeta.list)||void 0===n?void 0:n.fields]),v=A(s,y),{data:w,error:S,refetch:C,loading:$}=Object(g.useQuery)(Object(l.useMemo)(()=>{let e=[...v].map(e=>s.fields[e].controller.graphqlSelection).join("\n");return g.gql`
      query ($where: ${s.gqlNames.whereInputName}, $first: Int!, $skip: Int!, $sortBy: [${s.gqlNames.listSortName}!]) {
        items: ${s.gqlNames.listQueryName}(where: $where,first: $first, skip: $skip, sortBy: $sortBy) {
          ${v.has("id")?"":"id"}
          ${e}
        }
        meta: ${s.gqlNames.listQueryMetaName}(where: $where) {
          count
        }
      }
    `},[s,v]),{fetchPolicy:"cache-and-network",errorPolicy:"all",variables:{where:p.where,first:f,skip:(b-1)*f,sortBy:O?[`${O.field}_${O.direction}`]:void 0}}),[E,P]=Object(l.useState)({data:w,error:S});w&&E.data!==w&&P({data:w,error:S});const{data:R,error:z}=E,I=Object(x.d)(R,null===z||void 0===z?void 0:z.graphQLErrors),[q,D]=Object(l.useState)(()=>({itemsFromServer:void 0,selectedItems:new Set}));if(R&&R.items&&q.itemsFromServer!==R.items){const e=new Set;R.items.forEach(t=>{q.selectedItems.has(t.id)&&e.add(t.id)}),D({itemsFromServer:R.items,selectedItems:e})}const M=Object(a.t)(),N=!(null===(r=null===(i=h.data)||void 0===i||null===(c=i.keystone.adminMeta.list)||void 0===c?void 0:c.hideCreate)||void 0===r||r)||null;return Object(a.n)(k.c,{header:Object(a.n)(se,{listKey:e})},h.error?"Error...":R&&h.data?Object(a.n)(l.Fragment,null,Object(a.n)(a.j,{across:!0,gap:"medium",align:"center",marginTop:"xlarge"},N&&Object(a.n)(ce,{listKey:e}),R.meta.count||p.filters.length?Object(a.n)(G,{listKey:e}):null,p.filters.length?Object(a.n)(U,{filters:p.filters,list:s}):null),R.meta.count?Object(a.n)(l.Fragment,null,Object(a.n)(de,null,(()=>{const e=q.selectedItems,t=e.size;var n,r,o;return t?Object(a.n)(l.Fragment,null,Object(a.n)("span",{css:{marginRight:M.spacing.small}},"Selected ",t," of ",R.items.length),!(null===(n=null===(r=h.data)||void 0===r||null===(o=r.keystone.adminMeta.list)||void 0===o?void 0:o.hideDelete)||void 0===n||n)&&Object(a.n)(be,{list:s,selectedItems:e,refetch:C})):Object(a.n)(l.Fragment,null,Object(a.n)(te,{currentPage:b,pageSize:f,plural:s.plural,singular:s.singular,total:R.meta.count}),", sorted by ",Object(a.n)(re,{list:s}),"with"," ",Object(a.n)(J,{list:s,fieldModesByFieldPath:y})," ",$&&Object(a.n)(u.a,{label:"Loading item data",size:"small",tone:"active"}))})()),Object(a.n)(fe,{count:R.meta.count,currentPage:b,itemsGetter:I.get("items"),listKey:e,pageSize:f,selectedFields:v,sort:O,selectedItems:q.selectedItems,onSelectedItemsChange:e=>{D({itemsFromServer:q.itemsFromServer,selectedItems:e})}})):Object(a.n)(de,null,"No ",s.plural," found.")):Object(a.n)(a.b,{css:{height:`calc(100vh - ${k.b}px)`}},Object(a.n)(u.a,{label:"Loading item data",size:"large",tone:"passive"})))},ce=({listKey:e})=>{const t=Object(j.c)(e),n=Object(m.useRouter)(),[r,o]=Object(l.useState)(!1);return Object(a.n)(l.Fragment,null,Object(a.n)(i.a,{disabled:r,onClick:()=>{o(!0)},tone:"active",size:"small",weight:"bold"},"Create ",t.singular),Object(a.n)(b.c,{isOpen:r},Object(a.n)(w.a,{listKey:e,onCreate:({id:e})=>{n.push(`/${t.path}/[id]`,`/${t.path}/${e}`)},onClose:()=>{o(!1)}})))},se=({listKey:e})=>{const t=Object(j.c)(e);return Object(a.n)(l.Fragment,null,Object(a.n)("div",{css:{alignItems:"center",display:"flex",flex:1,justifyContent:"space-between"}},Object(a.n)(a.g,{type:"h3"},t.label)))},de=({children:e})=>Object(a.n)("p",{css:{minHeight:38,display:"flex",alignItems:"center"}},e),ue=({direction:e})=>Object(a.n)("span",{css:{borderLeft:"0.25em solid transparent",borderRight:"0.25em solid transparent",borderTop:"0.25em solid",display:"inline-block",height:0,marginLeft:"0.33em",marginTop:"-0.125em",verticalAlign:"middle",width:0,transform:`rotate(${"DESC"===e?"0deg":"180deg"})`}});function be({selectedItems:e,list:t,refetch:n}){const[r,o]=Object(g.useMutation)(Object(l.useMemo)(()=>g.gql`
  mutation($ids: [ID!]!) {
    ${t.gqlNames.deleteManyMutationName}(ids: $ids) {
      id
    }
  }
`,[t,e])),[c,s]=Object(l.useState)(!1),d=Object(f.b)();return Object(a.n)(l.Fragment,null,Object(a.n)(i.a,{isLoading:o.loading,tone:"negative",onClick:async()=>{s(!0)}},"Delete"),Object(a.n)(b.a,{isOpen:c,title:"Delete Confirmation",tone:"negative",actions:{confirm:{label:"Delete",action:async()=>{await r({variables:{ids:[...e]}}).catch(e=>{d.addToast({title:"Failed to delete items",message:e.message,tone:"negative"})}),d.addToast({title:"Deleted items successfully",tone:"positive"}),n()}},cancel:{label:"Cancel",action:()=>{s(!1)}}}},"Are you sure you want to delete ",e.size," ",1===e.size?t.singular:t.plural,"?"))}function fe({selectedFields:e,listKey:t,itemsGetter:n,count:r,sort:l,currentPage:i,pageSize:s,selectedItems:u,onSelectedItemsChange:b}){var f,g;const O=Object(j.c)(t),{query:h}=Object(m.useRouter)(),y=!O.fields[e.keys().next().value].views.Cell.supportsLinkTo;return Object(a.n)(a.a,{paddingBottom:"xlarge"},Object(a.n)(ge,null,Object(a.n)("colgroup",null,Object(a.n)("col",{width:"30"}),y&&Object(a.n)("col",{width:"30"}),[...e].map(e=>Object(a.n)("col",{key:e}))),Object(a.n)(Oe,null,Object(a.n)(pe,{css:{paddingLeft:0}},Object(a.n)("label",{css:{display:"flex",alignItems:"center",justifyContent:"start",cursor:"pointer"}},Object(a.n)(c.a,{size:"small",checked:u.size===(null===(f=n.data)||void 0===f?void 0:f.length),css:{cursor:"default"},onChange:()=>{var e;const t=new Set;var r;u.size!==(null===(e=n.data)||void 0===e?void 0:e.length)&&(null===(r=n.data)||void 0===r||r.forEach(e=>{null!==e&&null!==e.id&&t.add(e.id)}));b(t)}}))),y&&Object(a.n)(pe,null),[...e].map(e=>{const t=O.fields[e].label;return O.fields[e].isOrderable?Object(a.n)(pe,{key:e},Object(a.n)(v.a,{css:{display:"block",textDecoration:"none",color:"inherit",":hover":{color:"inherit"}},href:{query:Object(o.a)(Object(o.a)({},h),{},{sortBy:(null===l||void 0===l?void 0:l.field)===e&&"ASC"===l.direction?"-"+e:e})}},t,(null===l||void 0===l?void 0:l.field)===e&&Object(a.n)(ue,{direction:l.direction}))):Object(a.n)(pe,{key:e},t)})),Object(a.n)("tbody",null,(null!==(g=n.data)&&void 0!==g?g:[]).map((t,r)=>{const o=n.get(r);if(null===o.data||null===o.data.id)return o.errors?Object(a.n)("tr",{css:{color:"red"},key:"index:"+r},o.errors[0].message):null;const l=o.data.id;return Object(a.n)("tr",{key:l||"index:"+r},Object(a.n)(je,null,Object(a.n)("label",{css:{display:"flex",minHeight:38,alignItems:"center",justifyContent:"start"}},Object(a.n)(c.a,{size:"small",checked:u.has(l),css:{cursor:"default"},onChange:()=>{const e=new Set(u);u.has(l)?e.delete(l):e.add(l),b(e)}}))),y&&Object(a.n)(je,null,Object(a.n)(v.a,{css:{textDecoration:"none",minHeight:38,display:"flex",alignItems:"center",justifyContent:"center"},href:`/${O.path}/[id]`,as:`/${O.path}/${encodeURIComponent(l)}`},Object(a.n)(d,{size:"smallish","aria-label":"Go to item"}))),[...e].map((e,t)=>{const n=O.fields[e];let{Cell:r}=O.fields[e].views;const i={};for(const c of Object(x.c)(n.controller)){const n=o.get(c);if(n.errors){const o=n.errors[0].message;return Object(a.n)(je,{css:{color:"red"},key:e},0===t&&r.supportsLinkTo?Object(a.n)(p.a,{href:`/${O.path}/[id]`,as:`/${O.path}/${encodeURIComponent(l)}`},o):o)}i[c]=n.data}return Object(a.n)(je,{key:e},Object(a.n)(r,{field:n.controller,item:i,linkTo:0===t&&r.supportsLinkTo?{href:`/${O.path}/[id]`,as:`/${O.path}/${encodeURIComponent(l)}`}:void 0}))}))}))),Object(a.n)(ee,{listKey:t,total:r,currentPage:i,pageSize:s}))}const ge=({children:e})=>Object(a.n)("table",{css:{minWidth:"100%",tableLayout:"fixed","tr:last-child td":{borderBottomWidth:0}},cellPadding:"0",cellSpacing:"0"},e),Oe=({children:e})=>Object(a.n)("thead",null,Object(a.n)("tr",null,e)),pe=e=>{const{colors:t,spacing:n,typography:o}=Object(a.t)();return Object(a.n)("th",Object(r.a)({css:{backgroundColor:t.background,borderBottom:"2px solid "+t.border,color:t.foregroundDim,fontSize:o.fontSize.medium,fontWeight:o.fontWeight.medium,padding:n.small,textAlign:"left",position:"sticky",top:0}},e))},je=e=>{const{colors:t,typography:n}=Object(a.t)();return Object(a.n)("td",Object(r.a)({css:{borderBottom:"1px solid "+t.border,fontSize:n.fontSize.medium}},e))}},oGee:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n("cxan"),o=n("J8OT"),l=n("q9nS");const i=e=>{const{colors:t,spacing:n}=Object(o.t)();return Object(o.n)(l.a,Object(r.a)({css:{color:t.foreground,display:"block",padding:n.small,textDecoration:"none",":hover":{textDecoration:"underline"}}},e))}},rjhH:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("J8OT"),o=n("rkyN"),l=n("ERkP"),i=n("x8tt");const a=i.gql`
  mutation EndSession {
    endSession
  }
`,c=({children:e})=>{const[t,{loading:n,data:c}]=Object(i.useMutation)(a);return Object(l.useEffect)(()=>{null!==c&&void 0!==c&&c.endSession&&window.location.reload()},[c]),Object(r.n)(o.a,{size:"small",isLoading:n,onClick:()=>t()},e||"Sign out")}}}]);